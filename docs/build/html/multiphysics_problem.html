<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multi-Physics problem &mdash; feFlow 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scalar transport" href="scalar_transport_problem.html" />
    <link rel="prev" title="Physics problem" href="physics_problem.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            feFlow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Meshing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="meshing.html">Creating mesh</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Demos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app_demo.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib_demo.html">Library Demos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mesh.html">Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">io</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="physics.html">physics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="physics_problem.html">Physics problem</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multi-Physics problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#designing-multiphysics">Designing multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#class-definition">Class definition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#feFlow.physics.MultiPhysicsProblem"><code class="docutils literal notranslate"><span class="pre">MultiPhysicsProblem</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="scalar_transport_problem.html">Scalar transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="transient_scalar_transport_problem.html">Transient scalar transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="stokes_flow.html">Stokes flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="navier_stokes.html">Navier Stokes Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="transient_navier_stokes.html">Transient Navier Stokes Flow</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">feFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="physics.html">physics</a></li>
      <li class="breadcrumb-item active">Multi-Physics problem</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/multiphysics_problem.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="multi-physics-problem">
<h1>Multi-Physics problem<a class="headerlink" href="#multi-physics-problem" title="Permalink to this heading"></a></h1>
<p>This is a class that provide an interface for a coupled multi-physics problem. This class provides an interface for physics problem with multiple variables and multiple equation problems.</p>
<section id="designing-multiphysics">
<h2>Designing multiphysics<a class="headerlink" href="#designing-multiphysics" title="Permalink to this heading"></a></h2>
<p>MultiPhysics take in the different PhysicsProblem classes in the constructor, and build a <strong>monolithic</strong> problem based on all of the Physics. The weak formulation that we solve is the sum of all of the weak formulations from the base physics. Here, functions such as the trial, test, and solution functions requires a tag input indicating which variable you are pulling from. These functions will return the <strong>reference</strong> to the specific variable in the monolothic function object.</p>
</section>
<section id="class-definition">
<h2>Class definition<a class="headerlink" href="#class-definition" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">feFlow.physics.</span></span><span class="sig-name descname"><span class="pre">MultiPhysicsProblem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">physics_problems</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem" title="Permalink to this definition"></a></dt>
<dd><p>A class representing a multi-physics problem composed of multiple individual physics problems. The PhysicsProblems
must be defined on the same mesh space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>physics_problems</strong> – PhysicsProblem objects or their derived classes. You can initialize this class with as many PhysicsProblem object as needed. It is noted that every PhysicsProblem <strong>must</strong> have a unique tag.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.flux">
<span class="sig-name descname"><span class="pre">flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physics_tag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.flux" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.function_space">
<span class="sig-name descname"><span class="pre">function_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">physics_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.function_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.get_physics">
<span class="sig-name descname"><span class="pre">get_physics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">physics_tag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.get_physics" title="Permalink to this definition"></a></dt>
<dd><p>Get the underlying physics object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.get_physics_id">
<span class="sig-name descname"><span class="pre">get_physics_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">physics_tag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.get_physics_id" title="Permalink to this definition"></a></dt>
<dd><p>Get the id order of the physics based on the tag</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.get_residue">
<span class="sig-name descname"><span class="pre">get_residue</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.get_residue" title="Permalink to this definition"></a></dt>
<dd><p>Computes the residue of the problem.</p>
<p>To be implemented in derived classes.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>The residue as a Fenics form.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_bcs">
<span class="sig-name descname"><span class="pre">set_bcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiphysics_bcs_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_bcs" title="Permalink to this definition"></a></dt>
<dd><p>Create a list of fe.DirichletBC objects based on the values supplied in bcs_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bcs_dict</strong> (<em>dict</em>) – <p>A nested dictionary specifying boundary conditions.
The dictionary should have the following structure:</p>
<p>bcs_dict = {boundary_id: {<code class="docutils literal notranslate"><span class="pre">'type'</span></code>: <code class="docutils literal notranslate"><span class="pre">'dirichlet'</span></code> or <code class="docutils literal notranslate"><span class="pre">'neumann'</span></code>, <code class="docutils literal notranslate"><span class="pre">'value'</span></code>: <code class="docutils literal notranslate"><span class="pre">value</span></code>}, …}</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_element">
<span class="sig-name descname"><span class="pre">set_element</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_element" title="Permalink to this definition"></a></dt>
<dd><p>Build FEniCS MixedElement from the list of sub elements</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_function_space">
<span class="sig-name descname"><span class="pre">set_function_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_function_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_solution_function">
<span class="sig-name descname"><span class="pre">set_solution_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_solution_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_test_function">
<span class="sig-name descname"><span class="pre">set_test_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">te</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_test_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_trial_function">
<span class="sig-name descname"><span class="pre">set_trial_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_trial_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_weak_form">
<span class="sig-name descname"><span class="pre">set_weak_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_weak_form" title="Permalink to this definition"></a></dt>
<dd><p>The weak form here is the sum of all of the weak forms from every physics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.set_writer">
<span class="sig-name descname"><span class="pre">set_writer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.set_writer" title="Permalink to this definition"></a></dt>
<dd><p>Set the output file and field name for writing results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_file</strong> (<em>str</em>) – The name of the output file. The output file must ends in h5 or pvd. This will determine the format of the output</p></li>
<li><p><strong>field_name</strong> (<em>str</em>) – The name of the field to be written.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.solution_function">
<span class="sig-name descname"><span class="pre">solution_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">physics_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.solution_function" title="Permalink to this definition"></a></dt>
<dd><p>If physics_tag is None, this function will return the fe.Function object containing every solution field.
If physics_tag is provide, this function will provide a reference to the specific solution field inside the full fe.Function object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.test_function">
<span class="sig-name descname"><span class="pre">test_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">physics_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.test_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.trial_function">
<span class="sig-name descname"><span class="pre">trial_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">physics_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.trial_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="feFlow.physics.MultiPhysicsProblem.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_to_save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#feFlow.physics.MultiPhysicsProblem.write" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="physics_problem.html" class="btn btn-neutral float-left" title="Physics problem" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scalar_transport_problem.html" class="btn btn-neutral float-right" title="Scalar transport" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Chayut Teeraratkul.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>